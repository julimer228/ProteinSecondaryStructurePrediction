---
title: "The Protein Secondary Structure Prediction"
output: html_notebook
---

We have introduced a protein secondary structure prediction method based on the Logistic Regression classifier.

First, we need to load the data into the workspace

```{r}
library(stringr)

# function to read the data from file
read_protein_data<-function(filepath){
  lines <- readLines(filepath); # read all lines
  protein_data <- list(); # initialize variables
  current <- NULL;
  
  for( i in 1:length(lines)){
    
    line<-lines[i]; # read line
    
    if(i%%4 == 1){
      current$id<-substring(line, 2); # add id without '<<'
    } else if(i%%4 ==2){
      current$sequence<-line # read sequence
    } else if(i%%4 ==3){
      current$structure<-orthogonally_encoding(line)  #read secondary structure    
    } else if(i%%4 ==0){
      protein_data<-append(current, protein_data); # add protein to the list
    }
  }
  return(protein_data)
}

protein_data = read_protein_data("test.txt");
  
  
```

Then the protein structure needs to be orthogonally encoded.

```{r}

orthogonally_encoding<-function(sequence){
  
  amino_acids <- c("A", "C", "D", "E", "F", "G", "H", "I", "K", "L", "M", "N", "P", "Q",
                   "R", "S", "T", "V", "W", "Y","X");
  encoded_sequence <- matrix(0, nrow = length(sequence), ncol = length(amino_acids))
  
  for (i in 1:length(sequence)) {
    aa <- substring(sequence, i, i)
    idx <- match(aa, amino_acids)
    if (!is.na(idx)) {
      encoded_sequence[i, idx] <- 1
    }
  }
  
  return(encoded_sequence)
}
```
